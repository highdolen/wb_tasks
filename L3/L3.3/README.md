
# CommentTree 

Сервис для работы с древовидными комментариями с неограниченной вложенностью.
Реализован на Go с простым web‑интерфейсом на HTML/CSS/JS.

Проект выполнен в рамках задания, где требуется реализовать:
- создание комментариев и ответов;
- удаление комментариев вместе с поддеревом;
- постраничный вывод корневых комментариев;
- полнотекстовый поиск;
- визуализацию дерева комментариев в браузере.

---

## Возможности сервиса

HTTP API:

| Метод | Endpoint | Описание |
|------|----------|----------|
| POST | /comments | Создание комментария или ответа |
| GET | /comments | Получение корневых комментариев (с пагинацией) |
| GET | /comments?parent={id} | Получение детей комментария |
| GET | /comments/search?q= | Полнотекстовый поиск |
| DELETE | /comments/{id} | Удаление комментария и всех вложенных |

Функциональность:
- Неограниченная вложенность комментариев;
- Пагинация только по корневым комментариям;
- Сортировка по времени создания;
- Поиск по тексту комментариев;
- Простой web-интерфейс без фреймворков.

---

## Структура проекта

```
.
├── cmd/server/main.go          # Точка входа
├── internal/
│   ├── config/                # Загрузка и валидация конфига
│   ├── handlers/              # HTTP handlers
│   ├── models/                # Модели данных
│   ├── service/               # Бизнес‑логика
│   └── storage/               # In‑memory хранилище
├── frontend/                  # Web интерфейс
├── config.yaml
├── Dockerfile
└── docker-compose.yml
```

---

## Как запустить проект

### 1. Локально (Ubuntu / WSL)

Перейти в папку проекта:

```
cd /mnt/c/Users/Федор/Desktop/wb_task/L3/L3.3
```

Запуск сервера:

```
docker-compose up --build
```

Сервер стартует на:

```
http://localhost:8080
```

### 2. Запуск фронта

Перейти в папку frontend:

```
cd frontend
python3 -m http.server 5500
```

Открыть в браузере:

```
http://localhost:5500
```

---

## Как пользоваться интерфейсом

- Добавление нового корневого комментария — поле внизу страницы;
- Ответ на комментарий — кнопка **Ответить**;
- Раскрыть/скрыть ответы — кнопка **+ / -**;
- Удаление — кнопка **Удалить**;
- Поиск — поле сверху;
- Пагинация — кнопки **Назад / Вперед** (по 5 корневых комментариев на страницу).

---

## Конфигурация

Файл `config.yaml`:

```
server:
  host: "0.0.0.0"
  port: 8080
```

---

## Особенности реализации

- Для построения дерева используется `Path` (materialized path);
- Удаление поддерева выполняется за один проход по map;
- Пагинация применяется только к корневым комментариям;
- Дочерние комментарии подгружаются динамически;
- Хранилище — in-memory, потокобезопасное (`sync.RWMutex`).

---

## Проверка линтеров

```
go fmt ./...
go vet ./...
golangci-lint run
```

---

## Требования

- Go 1.20+
- Python 3 (для запуска frontend сервера)
